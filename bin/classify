#! /bin/zsh
#
# this is a bit of a hack but it works for the time being.
#

# Defaults
BANNER_HEIGHT=30
BANNER_FONT="-16:Bold"
CLASSIFICATION="u"

function finish {
bspc config top_padding 30
bspc config bottom_padding 0
}

trap finish SIGHUP SIGINT SIGTERM

# read command line parameters
while [ $# -gt 0 ]; do
  case "$1" in
    -c|--classification)
              CLASSIFICATION="$2"
              ;;
    -h|--height)
              BANNER_HEIGHT="$2"
              shift
              ;;
  esac
  shift
done

# set up bar
case "$CLASSIFICATION" in
  u)
    BANNER_TEXT="%{c}UNCLASSIFIED"
	COLOUR_BACKGROUND='#006600'
	COLOUR_FOREGROUND='#EBDBB2'
	;;
 fouo)
    BANNER_TEXT="%{c}UNCLASSIFIED // FOR OFFICIAL USE ONLY"
	COLOUR_BACKGROUND='#006600'
	COLOUR_FOREGROUND='#EBDBB2'
	;;
  c)
    BANNER_TEXT="%{c}CONFIDENTIAL"
	COLOUR_BACKGROUND='#076678'
	COLOUR_FOREGROUND='#EBDBB2'
	;;
  s)
    BANNER_TEXT="%{c}SECRET"
	COLOUR_BACKGROUND='#CC241D'
	COLOUR_FOREGROUND='#EBDBB2'
	;;
  ts)
    BANNER_TEXT="%{c}TOP SECRET"
	COLOUR_BACKGROUND='#D65D0E'
	COLOUR_FOREGROUND='#EBDBB2'
	;;
  sci)
    BANNER_TEXT="%{c}TOP SECRET // SCI"
	COLOUR_BACKGROUND='#FABD2F'
	COLOUR_FOREGROUND='#1D2021'
	;;
  core)
	BANNER_TEXT="%{c}TOP SECRET // COMINT // NOFORN"
	COLOUR_BACKGROUND='#FABD2F'
	COLOUR_FOREGROUND='#1D2021'
	;;
esac

bspc config top_padding $BANNER_HEIGHT
bspc config bottom_padding $BANNER_HEIGHT
export PANELY=$BANNER_HEIGHT

echo $BANNER_TEXT | lemonbar -p -g x$BANNER_HEIGHT -f "$BANNER_FONT" -F "$COLOUR_FOREGROUND" -B "$COLOUR_BACKGROUND" &
echo $BANNER_TEXT | lemonbar -p -b -g x$BANNER_HEIGHT -f "$BANNER_FONT" -F "$COLOUR_FOREGROUND" -B "$COLOUR_BACKGROUND" &
wait
